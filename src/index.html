<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="assets/css/app-style.css" />
    <link rel="stylesheet" href="assets/css/section.css">
    <link rel="stylesheet" href="assets/css/user.css">
    <link rel="stylesheet" href="assets/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/jquery-ui/jquery-ui.css">

    <link rel="import" href="sections/home.html">
    <link rel="import" href="sections/users.html">
    <link rel="import" href="sections/content.html">
	
	<!--<script type="text/javascript" src="js/jquery-ui-1.11.4/jquery-ui.min.js"></script>-->

    <style>
        #dialog label, #dialog input { display:block; }
        #dialog label { margin-top: 0.5em; }
        #dialog input, #dialog textarea { width: 95%; }
        #tabs { margin-top: 1em; }
        #tabs li .ui-icon-close { float: left; margin: 0.4em 0.2em 0 0; cursor: pointer; }
        #add_tab { cursor: pointer; }
    </style>


</head>
<body>
    <div id="wrapper">
        <div id="side-nav">
            <ul style="list-style:none">
                <li><i title="home" class="fa fa-home fa-fw" id="btn-home"></i></li>
                <li><i title="users" class="fa fa-users fa-fw" id="btn-user"></i></li>
                <li><i title="content" class="fa fa-list fa-fw" id="btn-content"></i></li>
                <li><i title="preview" class="fa fa-television fa-fw" aria-hidden="true" id="btn-preview"></i></li>
                <li><i title="multi user" class="fa fa-sitemap fa-fw" aria-hidden="true" id="btn-multi"></i></li>
            </ul>
        </div>

        <main id="main"></main>
    </div>


    <!--<script src="assets/jquery-ui/external/jquery/jquery.js"></script>-->
    <script>
        window.$ = window.jQuery = require('./assets/jquery-ui/external/jquery/jquery');
    </script>

    <script src="assets/jquery-ui/jquery-ui.js"></script>
    <script>
        // window.$ = window.jQuery = require('jquery');
        // window.$.ui = window.jQuery.ui = require('jquery-ui');
        // window.$.ui = window.jQuery.ui = require('./assets/jquery-ui/jquery-ui');
        require('./render-process/imports');
        require('./render-process/nav-menu');
        require('./render-process/users');

        

        console.log("version: " + jQuery.fn.jquery );
        console.log("ui-version: " + $.ui.version );

        // ------------------------------------------------------

        // $( function() {
        //     var tabs = $( "#tabs" ).tabs();
        //     tabs.find( ".ui-tabs-nav" ).sortable({
        //         axis: "x",
        //         stop: function() {
        //             tabs.tabs( "refresh" );
        //         }
        //     });
        // } );

        // ------------------------------------------------------

        $( function() {
            var temp = $( "#accordion" )
                            .accordion({
                                header: "> div > h3",
                                // icons: { "header": "ui-icon-plus", "activeHeader": "ui-icon-minus" },
                                collapsible: true,
                                active: false,
                                heightStyle: "content"
                            })
                            .sortable({
                                axis: "y",
                                handle: "h3",
                                stop: function( event, ui ) {
                                // IE doesn't register the blur when sorting
                                // so trigger focusout handlers to remove .ui-state-focus
                                ui.item.children( "h3" ).triggerHandler( "focusout" );
                        
                                // Refresh accordion to handle new order
                                $( this ).accordion( "refresh" );
                                }
                            });
            
            
        } );

        // --------------------------------------------------------------

        $( function() {
            var tabTitle = $( "#tab_title" ),
            tabContent = $( "#tab_content" ),
            tabTemplate = "<li><a href='#{href}'>#{label}</a> <span class='ui-icon ui-icon-close' role='presentation'>Remove Tab</span></li>",
            tabCounter = 2;
        
            var tabs = $( "#tabs" ).tabs();
            tabs.find( ".ui-tabs-nav" ).sortable({
                axis: "x",
                stop: function() {
                    tabs.tabs( "refresh" );
                }
            });
        
            // Modal dialog init: custom buttons and a "close" callback resetting the form inside
            var dialog = $( "#dialog" ).dialog({
            autoOpen: false,
            modal: true,
            buttons: {
                Add: function() {
                    addTab();
                    $( this ).dialog( "close" );
                },
                Cancel: function() {
                    $( this ).dialog( "close" );
                }
            },
            close: function() {
                form[ 0 ].reset();
            }
            });
        
            // AddTab form: calls addTab function on submit and closes the dialog
            var form = dialog.find( "form" ).on( "submit", function( event ) {
                addTab();
                dialog.dialog( "close" );
                event.preventDefault();
            });
        
            // Actual addTab function: adds new tab using the input from the form above
            function addTab() {
                var label = tabTitle.val() || "Tab " + tabCounter,
                    id = "tabs-" + tabCounter,
                    li = $( tabTemplate.replace( /#\{href\}/g, "#" + id ).replace( /#\{label\}/g, label ) ),
                    tabContentHtml = tabContent.val() || "Tab " + tabCounter + " content.";
            
                tabs.find( ".ui-tabs-nav" ).append( li );
                tabs.append( "<div id='" + id + "'><p>" + tabContentHtml + "</p></div>" );
                tabs.tabs( "refresh" );
                tabCounter++;
            }
        
            // AddTab button: just opens the dialog
            $( "#add_tab" )
                .button()
                .on( "click", function() {
                    dialog.dialog( "open" );
            });
        
            // Close icon: removing the tab on click
            tabs.on( "click", "span.ui-icon-close", function() {
                var panelId = $( this ).closest( "li" ).remove().attr( "aria-controls" );
                $( "#" + panelId ).remove();
                tabs.tabs( "refresh" );
            });
        
            tabs.on( "keyup", function( event ) {
                if ( event.altKey && event.keyCode === $.ui.keyCode.BACKSPACE ) {
                    var panelId = tabs.find( ".ui-tabs-active" ).remove().attr( "aria-controls" );
                    $( "#" + panelId ).remove();
                    tabs.tabs( "refresh" );
                }
            });
        } );
    </script>
</body>


</html>